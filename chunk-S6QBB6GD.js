import{a as Z,b as H}from"./chunk-YUGMXLOU.js";import{b as F,c as Y,d as C,e as K,f as j,h as B,i as L,j as $,n as q,p as U}from"./chunk-AAETB4I6.js";import{a as G}from"./chunk-DO7T4SEG.js";import{a as V}from"./chunk-2L2WFLXW.js";import{Ca as I,Hb as N,Ib as R,J as k,La as _,Ma as x,O as b,Pa as D,Qa as A,Ra as h,Sa as n,T as g,Ta as i,U as f,Ua as p,Ya as M,_a as m,a as E,ab as l,ea as P,j as d,jb as o,kb as S,lb as y,mb as w,ra as c,sb as T,tb as z,y as u}from"./chunk-62IWQYBS.js";var v=class a{storage=b(V);mockData=b(G);STORAGE_KEY="subscriptions";constructor(){this.ensureData()}ensureData(){this.storage.getItem(this.STORAGE_KEY)||this.storage.setItem(this.STORAGE_KEY,this.mockData.getInitialSubscriptions())}getSubscriptions(){let t=this.storage.getItem(this.STORAGE_KEY)||[];return d(t).pipe(u(400))}getSubscriptionById(t){let r=(this.storage.getItem(this.STORAGE_KEY)||[]).find(s=>s.id===t);return d(r).pipe(u(200))}createSubscription(t){let e=this.storage.getItem(this.STORAGE_KEY)||[],r={id:`sub-${Date.now()}`,gymId:"gym-001",name:t.name,price:t.price,durationMonths:t.durationMonths,description:t.description||"",maxEntries:t.maxEntries};return e.push(r),this.storage.setItem(this.STORAGE_KEY,e),d(r).pipe(u(600))}updateSubscription(t,e){let r=this.storage.getItem(this.STORAGE_KEY)||[],s=r.findIndex(O=>O.id===t);if(s!==-1)return r[s]=E(E({},r[s]),e),this.storage.setItem(this.STORAGE_KEY,r),d(r[s]).pipe(u(400));throw new Error("Subscription not found")}deleteSubscription(t){let e=this.storage.getItem(this.STORAGE_KEY)||[],r=e.length;return e=e.filter(s=>s.id!==t),e.length!==r?(this.storage.setItem(this.STORAGE_KEY,e),d(!0).pipe(u(400))):d(!1)}static \u0275fac=function(e){return new(e||a)};static \u0275prov=k({token:a,factory:a.\u0275fac,providedIn:"root"})};var W=(a,t)=>t.id;function X(a,t){a&1&&(n(0,"div",26),p(1,"app-input",30),i())}function ee(a,t){if(a&1){let e=M();n(0,"div",6)(1,"div",10)(2,"h2",11),o(3,"Crea Nuovo Abbonamento"),i(),n(4,"button",12),m("click",function(){g(e);let s=l();return f(s.cancelCreate())}),o(5,"\u2715"),i()(),n(6,"form",13),m("ngSubmit",function(){g(e);let s=l();return f(s.onSubmit())}),n(7,"div",14)(8,"div",15),p(9,"app-input",16),i(),n(10,"div",17)(11,"div",15),p(12,"app-input",18),i(),n(13,"div",15),p(14,"app-input",19),i()(),n(15,"div",15)(16,"label",20),o(17,"DESCRIZIONE"),i(),p(18,"textarea",21),i(),n(19,"div",22)(20,"label",23),p(21,"input",24),n(22,"span",25),o(23,"Limita gli ingressi mensili"),i()(),_(24,X,2,0,"div",26),i()(),n(25,"div",27)(26,"app-button",28),m("clicked",function(){g(e);let s=l();return f(s.cancelCreate())}),o(27," Annulla "),i(),n(28,"app-button",29),o(29," Crea Abbonamento "),i()()()()}if(a&2){let e,r=l();c(6),h("formGroup",r.form),c(3),h("error",r.getError("name")),c(3),h("error",r.getError("price")),c(2),h("error",r.getError("durationMonths")),c(10),x((e=r.form.get("isLimited"))!=null&&e.value?24:-1),c(4),h("loading",r.loading)("disabled",r.form.invalid)}}function te(a,t){if(a&1&&(n(0,"p",41),o(1),i()),a&2){let e=l().$implicit;c(),S(e.description)}}function ne(a,t){if(a&1&&(n(0,"div",43)(1,"span",44),o(2,"\u{1F3AB}"),i(),n(3,"span",45),o(4),i()()),a&2){let e=l().$implicit;c(4),y("Max ",e.maxEntries," ingressi/mese")}}function ie(a,t){a&1&&(n(0,"div",46)(1,"span",44),o(2,"\u267E\uFE0F"),i(),n(3,"span",45),o(4,"Ingressi illimitati"),i()())}function re(a,t){if(a&1){let e=M();n(0,"div",31)(1,"div",32)(2,"div",33)(3,"span",34),o(4,"\u{1F48E}"),i()(),n(5,"button",35),m("click",function(){let s=g(e).$implicit,O=l(2);return f(O.deleteSub(s.id))}),n(6,"span"),o(7,"\u{1F5D1}\uFE0F"),i()()(),n(8,"div",36)(9,"h3",37),o(10),i(),n(11,"div",38)(12,"span",39),o(13),T(14,"currency"),i(),n(15,"span",40),o(16),i()(),_(17,te,2,1,"p",41),n(18,"div",42)(19,"div",43)(20,"span",44),o(21,"\u{1F4C5}"),i(),n(22,"span",45),o(23),i()(),_(24,ne,5,1,"div",43)(25,ie,5,0,"div",46),i()(),n(26,"div",47)(27,"div",48)(28,"div",49)(29,"span",50),o(30),i(),n(31,"span",51),o(32,"Iscritti attivi"),i()(),n(33,"div",49)(34,"span",50),o(35),i(),n(36,"span",51),o(37,"Entrate/mese"),i()()()()()}if(a&2){let e=t.$implicit,r=l(2);c(10),S(e.name),c(3),S(z(14,10,e.price,"EUR")),c(3),w("/ ",e.durationMonths," ",e.durationMonths===1?"mese":"mesi"),c(),x(e.description?17:-1),c(6),w("Validit\xE0: ",e.durationMonths," ",e.durationMonths===1?"mese":"mesi"),c(),x(e.maxEntries?24:25),c(6),S(r.getActiveMembers(e.id)),c(5),y("\u20AC ",r.getMonthlyRevenue(e.id))}}function oe(a,t){if(a&1&&(n(0,"div",8),D(1,re,38,13,"div",31,W),i()),a&2){let e=l();c(),A(e.subscriptions())}}function ae(a,t){if(a&1){let e=M();n(0,"div",9)(1,"div",52),o(2,"\u{1F4B3}"),i(),n(3,"h3",53),o(4,"Nessun piano abbonamento"),i(),n(5,"p",54),o(6," Inizia creando il tuo primo piano di abbonamento per gli iscritti della palestra. "),i(),n(7,"app-button",5),m("clicked",function(){g(e);let s=l();return f(s.openCreateMode())}),o(8," Crea primo piano "),i()()}}var J=class a{subService=b(v);fb=b(q);subscriptions=P([]);isCreating=P(!1);loading=!1;form=this.fb.group({name:["",C.required],price:[0,[C.required,C.min(0)]],durationMonths:[1,[C.required,C.min(1)]],description:[""],isLimited:[!1],maxEntries:[10]});constructor(){this.refresh()}refresh(){this.subService.getSubscriptions().subscribe(t=>{this.subscriptions.set(t)})}openCreateMode(){this.isCreating.set(!0),this.form.reset({price:50,durationMonths:1,isLimited:!1,maxEntries:10})}cancelCreate(){this.isCreating.set(!1)}onSubmit(){if(this.form.invalid)return;this.loading=!0;let t=this.form.value,e={name:t.name,price:t.price,durationMonths:t.durationMonths,description:t.description||"",maxEntries:t.isLimited?t.maxEntries:void 0};this.subService.createSubscription(e).subscribe({next:()=>{this.loading=!1,this.isCreating.set(!1),this.refresh()},error:()=>this.loading=!1})}deleteSub(t){confirm("Sei sicuro di voler eliminare questo piano?")&&this.subService.deleteSubscription(t).subscribe(()=>this.refresh())}getError(t){return this.form.get(t)?.errors?"Campo non valido":void 0}getActiveMembers(t){return Math.floor(Math.random()*50)+5}getMonthlyRevenue(t){let e=this.subscriptions().find(s=>s.id===t);if(!e)return 0;let r=this.getActiveMembers(t);return e.price/e.durationMonths*r}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=I({type:a,selectors:[["app-subscriptions"]],decls:16,vars:2,consts:[[1,"subscriptions-container"],[1,"subscriptions-header"],[1,"header-top"],[1,"page-title"],[1,"page-subtitle"],[3,"clicked"],[1,"form-card"],[1,"subscriptions-content"],[1,"subscriptions-grid"],[1,"empty-state"],[1,"form-header"],[1,"form-title"],[1,"close-btn",3,"click"],[1,"subscription-form",3,"ngSubmit","formGroup"],[1,"form-grid"],[1,"form-field"],["label","NOME PIANO","formControlName","name","placeholder","es. Abbonamento Mensile",3,"error"],[1,"form-row"],["label","PREZZO (\u20AC)","type","number","formControlName","price","placeholder","50",3,"error"],["label","DURATA (mesi)","type","number","formControlName","durationMonths","placeholder","1",3,"error"],[1,"field-label"],["formControlName","description","placeholder","Descrizione del piano (opzionale)","rows","3",1,"textarea-field"],[1,"checkbox-group"],[1,"checkbox-wrapper"],["type","checkbox","formControlName","isLimited"],[1,"checkbox-label"],[1,"form-field",2,"margin-top","1rem"],[1,"form-actions"],["variant","secondary","type","button",3,"clicked"],["type","submit",3,"loading","disabled"],["label","INGRESSI MASSIMI","type","number","formControlName","maxEntries","placeholder","10"],[1,"subscription-card"],[1,"card-header"],[1,"plan-badge"],[1,"badge-icon"],[1,"delete-btn",3,"click"],[1,"card-body"],[1,"plan-name"],[1,"price-section"],[1,"price-amount"],[1,"price-period"],[1,"plan-description"],[1,"plan-features"],[1,"feature-item"],[1,"feature-icon"],[1,"feature-text"],[1,"feature-item","unlimited"],[1,"card-footer"],[1,"stats-row"],[1,"stat-item"],[1,"stat-value"],[1,"stat-label"],[1,"empty-icon"],[1,"empty-title"],[1,"empty-message"]],template:function(e,r){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"h1",3),o(5,"Gestione Abbonamenti"),i(),n(6,"p",4),o(7,"Crea e gestisci i piani di abbonamento della tua palestra"),i()(),n(8,"app-button",5),m("clicked",function(){return r.openCreateMode()}),n(9,"span"),o(10,"+"),i(),o(11," Nuovo Piano "),i()()(),_(12,ee,30,7,"div",6),n(13,"div",7),_(14,oe,3,0,"div",8)(15,ae,9,0,"div",9),i()()),e&2&&(c(12),x(r.isCreating()?12:-1),c(2),x(r.subscriptions().length>0?14:15))},dependencies:[R,U,B,Y,F,K,j,$,L,Z,H,N],styles:['.subscriptions-container[_ngcontent-%COMP%]{background:#c7d6d5;min-height:100vh;padding:2rem}.subscriptions-header[_ngcontent-%COMP%]{margin-bottom:2rem}.header-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;background:#fff9;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border:1px solid rgba(0,0,0,.08);border-radius:1rem;padding:1.5rem;box-shadow:0 4px 12px #0000000a}.page-title[_ngcontent-%COMP%]{font-size:1.875rem;font-weight:700;color:#1a1d21;margin:0 0 .25rem}.page-subtitle[_ngcontent-%COMP%]{font-size:1rem;color:#4a5568;margin:0}.form-card[_ngcontent-%COMP%]{background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:1rem;padding:1.5rem;margin-bottom:2rem;box-shadow:0 8px 24px #00000014;animation:_ngcontent-%COMP%_slideDown .3s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:2px solid rgba(0,0,0,.08)}.form-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#1a1d21;margin:0}.close-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:9999px;background:#0000000a;border:none;color:#4a5568;font-size:1.25rem;cursor:pointer;transition:all .2s}.close-btn[_ngcontent-%COMP%]:hover{background:#e71d361a;color:#e71d36;transform:rotate(90deg)}.subscription-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.form-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.25rem}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.form-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.field-label[_ngcontent-%COMP%]{font-size:11px;text-transform:uppercase;letter-spacing:.1em;color:#4a5568;font-weight:700}.textarea-field[_ngcontent-%COMP%]{width:100%;padding:.75rem 1rem;background:#fff;border:2px solid rgba(0,0,0,.08);border-radius:.75rem;color:#1a1d21;font-size:1rem;font-family:inherit;resize:vertical;transition:all .3s;outline:none}.textarea-field[_ngcontent-%COMP%]::placeholder{color:#4a5568;opacity:.5}.textarea-field[_ngcontent-%COMP%]:focus{border-color:#3066be;box-shadow:0 0 0 3px #3066be33}.checkbox-group[_ngcontent-%COMP%]{padding:1rem;background:#3066be08;border:1px solid rgba(48,102,190,.1);border-radius:.75rem}.checkbox-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;cursor:pointer}.checkbox-wrapper[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;cursor:pointer;accent-color:#3066BE}.checkbox-label[_ngcontent-%COMP%]{font-size:1rem;font-weight:500;color:#1a1d21}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding-top:1rem;border-top:1px solid rgba(0,0,0,.08)}.subscriptions-content[_ngcontent-%COMP%]{min-height:400px}.subscriptions-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:1.5rem}.subscription-card[_ngcontent-%COMP%]{background:#fff;border:1px solid rgba(0,0,0,.08);border-radius:1rem;overflow:hidden;transition:all .3s cubic-bezier(.4,0,.2,1);box-shadow:0 4px 6px #00000005;position:relative}.subscription-card[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:0;right:0;height:6px;background:linear-gradient(90deg,#e71d36,#3066be)}.subscription-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 20px 40px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;padding:1.5rem 1.5rem 0}.plan-badge[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:.75rem;background:linear-gradient(135deg,#3066be,#255198);display:flex;align-items:center;justify-content:center;box-shadow:0 8px 16px #3066be4d}.badge-icon[_ngcontent-%COMP%]{font-size:1.5rem}.delete-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:9999px;background:#0000000a;border:none;cursor:pointer;transition:all .2s;font-size:18px}.delete-btn[_ngcontent-%COMP%]:hover{background:#e71d361a;transform:scale(1.1)}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.plan-name[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#1a1d21;margin:0 0 1rem}.price-section[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:.5rem;margin-bottom:1.25rem}.price-amount[_ngcontent-%COMP%]{font-size:2.25rem;font-weight:700;color:#3066be;line-height:1}.price-period[_ngcontent-%COMP%]{font-size:.875rem;color:#4a5568;font-weight:500}.plan-description[_ngcontent-%COMP%]{font-size:.875rem;color:#4a5568;margin:0 0 1.25rem;line-height:1.6}.plan-features[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.feature-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem;background:#00000005;border-radius:.5rem}.feature-item.unlimited[_ngcontent-%COMP%]{background:#3066be0d;border:1px solid rgba(48,102,190,.1)}.feature-item.unlimited[_ngcontent-%COMP%]   .feature-text[_ngcontent-%COMP%]{color:#3066be;font-weight:700}.feature-icon[_ngcontent-%COMP%]{font-size:20px;opacity:.8}.feature-text[_ngcontent-%COMP%]{font-size:.875rem;color:#1a1d21;font-weight:500}.card-footer[_ngcontent-%COMP%]{padding:1.25rem 1.5rem 1.5rem;border-top:1px solid rgba(0,0,0,.08);background:#00000003}.stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center}.stat-value[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:700;color:#1a1d21;line-height:1;margin-bottom:.25rem}.stat-label[_ngcontent-%COMP%]{font-size:11px;text-transform:uppercase;letter-spacing:.05em;color:#4a5568;font-weight:700}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;text-align:center;background:#fff6;border:2px dashed rgba(0,0,0,.08);border-radius:1rem}.empty-icon[_ngcontent-%COMP%]{font-size:64px;margin-bottom:1.25rem;opacity:.5}.empty-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#1a1d21;margin:0 0 .5rem}.empty-message[_ngcontent-%COMP%]{font-size:1rem;color:#4a5568;margin:0 0 1.5rem;max-width:400px}@media(max-width:768px){.subscriptions-container[_ngcontent-%COMP%]{padding:1rem}.header-top[_ngcontent-%COMP%]{flex-direction:column;gap:1rem;align-items:stretch}.header-top[_ngcontent-%COMP%]   app-button[_ngcontent-%COMP%]{width:100%}.subscriptions-grid[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%]{grid-template-columns:1fr}}@keyframes _ngcontent-%COMP%_fadeInUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.subscription-card[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeInUp .4s ease-out backwards}.subscription-card[_ngcontent-%COMP%]:nth-child(1){animation-delay:.05s}.subscription-card[_ngcontent-%COMP%]:nth-child(2){animation-delay:.1s}.subscription-card[_ngcontent-%COMP%]:nth-child(3){animation-delay:.15s}.subscription-card[_ngcontent-%COMP%]:nth-child(4){animation-delay:.2s}.subscription-card[_ngcontent-%COMP%]:nth-child(5){animation-delay:.25s}.subscription-card[_ngcontent-%COMP%]:nth-child(6){animation-delay:.3s}.subscription-card[_ngcontent-%COMP%]:nth-child(7){animation-delay:.35s}.subscription-card[_ngcontent-%COMP%]:nth-child(8){animation-delay:.4s}.subscription-card[_ngcontent-%COMP%]:nth-child(9){animation-delay:.45s}.subscription-card[_ngcontent-%COMP%]:nth-child(10){animation-delay:.5s}.subscription-card[_ngcontent-%COMP%]:nth-child(11){animation-delay:.55s}.subscription-card[_ngcontent-%COMP%]:nth-child(12){animation-delay:.6s}']})};export{J as SubscriptionsComponent};
