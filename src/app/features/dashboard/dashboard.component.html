<div class="dashboard-container">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="welcome-section">
      <div>
        <h1 class="greeting">
          Benvenuto, {{ currentUser()?.firstName || 'Utente' }}! ðŸ‘‹
        </h1>
        <p class="subtitle">
          {{ currentUser()?.role === 'manager' ? `Ecco cosa sta succedendo nella ${currentUser()?.gymName}` : 'Pronto
          per il
          prossimo allenamento?' }}
        </p>
      </div>
      <div class="user-avatar">
        {{ currentUser()?.firstName?.charAt(0) || 'U' }}{{ currentUser()?.lastName?.charAt(0) || '' }}
      </div>
    </div>
  </div>

  <!-- Quick Actions (solo per Manager) -->
  @if (currentUser()?.role === 'manager') {
  <div class="quick-actions-section">
    <h2 class="section-title">Azioni Rapide</h2>
    <div class="quick-actions">
      <button class="action-btn blue" [routerLink]="['/app/members']" [queryParams]="{ action: 'add' }">
        <div class="action-icon">âž•</div>
        <span class="action-label">Nuovo Iscritto</span>
      </button>
      <button class="action-btn red" [routerLink]="['/app/schedule']" [queryParams]="{ action: 'add' }">
        <div class="action-icon">ðŸ¥Š</div>
        <span class="action-label">Nuova Lezione</span>
      </button>
      <button class="action-btn blue" [routerLink]="['/app/subscriptions']">
        <div class="action-icon">ðŸ’³</div>
        <span class="action-label">Rinnova Abbonamento</span>
      </button>
    </div>
  </div>
  }

  <!-- Prossime Lezioni -->
  <div class="upcoming-section">
    <div class="section-header">
      <h2 class="section-title">Prossime Lezioni di Oggi</h2>
      <a [routerLink]="['/app/schedule']" class="view-all-btn">Vedi tutte â†’</a>
    </div>

    @if (todayCourses.length > 0) {
    <div class="lessons-list">
      @for (course of todayCourses; track course.id) {
      <div class="lesson-card" [class]="getLessonClass($index)">
        <div class="lesson-time">{{ course.startTime }}</div>
        <div class="lesson-info">
          <div class="lesson-name">{{ course.name }}</div>
          <div class="lesson-instructor">
            <span class="instructor-icon">ðŸ¥‹</span>
            {{ course.instructor }}
          </div>
        </div>
        <div class="lesson-capacity">
          <div class="capacity-bar">
            <div class="capacity-fill" [style.width.%]="getCapacityPercentage(course)"></div>
          </div>
          <span class="capacity-text">{{ course.enrolledMembers.length }} / {{ course.maxCapacity }}</span>
        </div>
      </div>
      }
    </div>
    } @else {
    <div class="empty-lessons">
      <div class="empty-icon">ðŸ“…</div>
      <p class="empty-text">Nessun corso programmato per oggi.</p>
    </div>
    }
  </div>

  <!-- Avvisi -->
  <div class="content-grid">

    <!-- Avvisi Importanti -->
    <div class="alerts-section">
      <div class="section-header">
        <div class="header-with-icon">
          <div class="header-icon info">ðŸ“¢</div>
          <h2 class="section-title">Avvisi</h2>
        </div>
      </div>

      <div class="alerts-list">
        <div class="alert-card important">
          <div class="alert-badge">Importante</div>
          <div class="alert-content">
            <h3 class="alert-title">Manutenzione Programmata</h3>
            <p class="alert-message">La palestra rimarrÃ  chiusa il giorno 25 Aprile per festa nazionale.</p>
          </div>
        </div>

        <div class="alert-card reminder">
          <div class="alert-badge">Promemoria</div>
          <div class="alert-content">
            <h3 class="alert-title">Riunione Staff</h3>
            <p class="alert-message">MercoledÃ¬ 28 Gennaio alle ore 14:00 - Sala riunioni</p>
          </div>
        </div>
      </div>
    </div>
  </div>


  <!-- Stats Grid -->
  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-header">
        <div class="stat-icon blue">ðŸ‘¥</div>
        <span class="stat-label">Iscritti Attivi</span>
      </div>
      <div class="stat-value">247</div>
      <div class="stat-change positive">
        <span>â†—</span> +12% questo mese
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-header">
        <div class="stat-icon red">ðŸ“…</div>
        <span class="stat-label">Lezioni Oggi</span>
      </div>
      <div class="stat-value">{{ todayCourses.length }}</div>
      <div class="stat-change">
        {{ getTotalEnrolled() }} iscritti totali
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-header">
        <div class="stat-icon blue">ðŸ’°</div>
        <span class="stat-label">Entrate Mese</span>
      </div>
      <div class="stat-value">â‚¬ 8,450</div>
      <div class="stat-change positive">
        <span>â†—</span> +8% rispetto al mese scorso
      </div>
    </div>

    <div class="stat-card">
      <div class="stat-header">
        <div class="stat-icon red">ðŸ”¥</div>
        <span class="stat-label">Lezioni Settimana</span>
      </div>
      <div class="stat-value">42</div>
      <div class="stat-change">
        Media: 6 al giorno
      </div>
    </div>
  </div>

</div>