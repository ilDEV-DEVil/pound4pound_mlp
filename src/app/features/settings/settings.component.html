<div class="settings-container fade-in">
    <div class="flex flex-col md:flex-row gap-6">
        <!-- Sidebar Navigation -->
        <div class="w-full md:w-64 flex-shrink-0">
            <app-card class="sticky top-24">
                <nav class="flex flex-col gap-1">
                    <button (click)="setActiveTab('profile')" [class.active]="activeTab() === 'profile'"
                        class="nav-item">
                        <span class="text-xl">üë§</span>
                        <span class="font-medium">Profilo</span>
                    </button>
                    <button (click)="setActiveTab('app')" [class.active]="activeTab() === 'app'" class="nav-item">
                        <span class="text-xl">‚öôÔ∏è</span>
                        <span class="font-medium">Preferenze</span>
                    </button>
                    <button (click)="setActiveTab('security')" [class.active]="activeTab() === 'security'"
                        class="nav-item">
                        <span class="text-xl">üîí</span>
                        <span class="font-medium">Sicurezza</span>
                    </button>

                    <div class="h-px bg-gray-700 my-2"></div>

                    <button (click)="logout()" class="nav-item text-red-400 hover:bg-red-900/20">
                        <span class="text-xl">üö™</span>
                        <span class="font-medium">Logout</span>
                    </button>
                </nav>
            </app-card>
        </div>

        <!-- Main Content Area -->
        <div class="flex-1">
            <!-- Profile Tab -->
            @if (activeTab() === 'profile') {
            <div class="animate-enter">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-white">Il mio Profilo</h2>
                    <p class="text-gray-400">Gestisci le tue informazioni personali</p>
                </div>

                <app-card>
                    <div
                        class="flex flex-col items-center sm:flex-row gap-6 mb-8 p-4 bg-gray-800/50 rounded-lg border border-gray-700">
                        <div class="relative group cursor-pointer">
                            <div
                                class="w-24 h-24 rounded-full bg-accent text-white flex items-center justify-center text-3xl font-bold border-4 border-gray-800 shadow-xl overflow-hidden">
                                {{ profileData().firstName.charAt(0) }}{{ profileData().lastName.charAt(0) }}
                            </div>
                            <div
                                class="absolute inset-0 bg-black/60 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity">
                                <span>üì∑</span>
                            </div>
                        </div>
                        <div class="text-center sm:text-left">
                            <h3 class="text-xl font-bold">{{ profileData().firstName }} {{ profileData().lastName }}
                            </h3>
                            <p class="text-accent mb-2">Atleta Intermedio</p>
                            <button class="text-xs bg-gray-700 hover:bg-gray-600 px-3 py-1 rounded transition-colors">
                                Cambia Foto
                            </button>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <app-input label="Nome" placeholder="Il tuo nome" [(ngModel)]="profileData().firstName">
                        </app-input>
                        <app-input label="Cognome" placeholder="Il tuo cognome" [(ngModel)]="profileData().lastName">
                        </app-input>
                        <app-input label="Email" type="email" placeholder="email@esempio.com"
                            [(ngModel)]="profileData().email">
                        </app-input>
                        <app-input label="Telefono" type="tel" placeholder="+39 ..." [(ngModel)]="profileData().phone">
                        </app-input>
                    </div>

                    <div class="mb-6">
                        <label class="block text-sm font-medium text-gray-400 mb-1">Bio</label>
                        <textarea
                            class="w-full bg-gray-800 border-gray-700 rounded-md text-white focus:ring-accent focus:border-accent"
                            rows="3" [(ngModel)]="profileData().bio"></textarea>
                    </div>

                    <div class="flex justify-end">
                        <app-button (click)="saveProfile()" [loading]="isLoading">
                            Salva Modifiche
                        </app-button>
                    </div>
                </app-card>
            </div>
            }

            <!-- App Settings Tab -->
            @if (activeTab() === 'app') {
            <div class="animate-enter">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-white">Preferenze App</h2>
                    <p class="text-gray-400">Personalizza la tua esperienza</p>
                </div>

                <app-card class="mb-6">
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <span>üé®</span> Aspetto
                    </h3>
                    <div class="flex items-center justify-between p-3 bg-gray-800/30 rounded mb-2">
                        <div>
                            <div class="font-bold">Dark Mode</div>
                            <div class="text-xs text-gray-400">Usa il tema scuro per l'interfaccia</div>
                        </div>
                        <!-- Mock Toggle -->
                        <div class="w-12 h-6 rounded-full relative cursor-pointer transition-colors"
                            [class.bg-accent]="appSettings().darkMode" [class.bg-gray-600]="!appSettings().darkMode"
                            (click)="appSettings().darkMode = !appSettings().darkMode">
                            <div class="absolute top-1 w-4 h-4 rounded-full bg-white transition-all duration-200"
                                [class.left-7]="appSettings().darkMode" [class.left-1]="!appSettings().darkMode"></div>
                        </div>
                    </div>
                </app-card>

                <app-card>
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <span>üîî</span> Notifiche
                    </h3>

                    <div class="space-y-4">
                        <div class="flex items-center justify-between p-2">
                            <div>
                                <div class="font-medium">Notifiche Push</div>
                                <div class="text-xs text-gray-400">Ricevi avvisi per le lezioni</div>
                            </div>
                            <input type="checkbox" [(ngModel)]="appSettings().notifications"
                                class="w-5 h-5 accent-accent">
                        </div>
                        <div class="h-px bg-gray-800"></div>

                        <div class="flex items-center justify-between p-2">
                            <div>
                                <div class="font-medium">Email Newsletter</div>
                                <div class="text-xs text-gray-400">Ricevi novit√† e offerte</div>
                            </div>
                            <input type="checkbox" [(ngModel)]="appSettings().emailUpdates"
                                class="w-5 h-5 accent-accent">
                        </div>
                        <div class="h-px bg-gray-800"></div>

                        <div class="flex items-center justify-between p-2">
                            <div>
                                <div class="font-medium">Profilo Pubblico</div>
                                <div class="text-xs text-gray-400">Mostra il tuo profilo agli altri membri</div>
                            </div>
                            <input type="checkbox" [(ngModel)]="appSettings().publicProfile"
                                class="w-5 h-5 accent-accent">
                        </div>
                    </div>

                    <div class="flex justify-end mt-6">
                        <app-button (click)="saveAppSettings()" [loading]="isLoading">
                            Salva Preferenze
                        </app-button>
                    </div>
                </app-card>
            </div>
            }

            <!-- Security Tab -->
            @if (activeTab() === 'security') {
            <div class="animate-enter">
                <div class="mb-6">
                    <h2 class="text-2xl font-bold text-white">Sicurezza</h2>
                    <p class="text-gray-400">Gestisci password e accessi</p>
                </div>

                <app-card>
                    <h3 class="text-lg font-bold mb-4 flex items-center gap-2">
                        <span>üîë</span> Modifica Password
                    </h3>

                    <div class="flex flex-col gap-4 max-w-md">
                        <app-input label="Password Attuale" type="password"
                            [(ngModel)]="securityData().currentPassword">
                        </app-input>

                        <app-input label="Nuova Password" type="password" [(ngModel)]="securityData().newPassword">
                        </app-input>

                        <app-input label="Conferma Password" type="password"
                            [(ngModel)]="securityData().confirmPassword">
                        </app-input>
                    </div>

                    <div class="mt-4 p-3 bg-yellow-900/20 border border-yellow-600/30 rounded text-sm text-yellow-200">
                        ‚ö†Ô∏è Assicurati di usare una password sicura con almeno 8 caratteri.
                    </div>

                    <div class="flex justify-end mt-6">
                        <app-button (click)="updatePassword()" [loading]="isLoading">
                            Aggiorna Password
                        </app-button>
                    </div>
                </app-card>
            </div>
            }
        </div>
    </div>
</div>