<div class="members-container">
    <!-- Header -->
    <div class="members-header">
        <div class="header-top">
            <div>
                <h1 class="page-title">Gestione Iscritti</h1>
                <p class="page-subtitle">Amministra i membri della tua palestra</p>
            </div>
            <app-button (clicked)="openAddModal()">
                <span>+</span> Nuovo Iscritto
            </app-button>
        </div>

        <!-- Search & Filters -->
        <div class="filters-section">
            <div class="search-wrapper">
                <app-input type="search" placeholder="Cerca per nome, cognome o email..." [(ngModel)]="searchQuery"
                    (ngModelChange)="filterMembers()"></app-input>
            </div>

            <div class="filter-tabs">
                <button class="filter-tab" [class.active]="filterStatus === 'all'" (click)="setFilter('all')">
                    <span class="tab-label">Tutti</span>
                    <span class="tab-count">{{ totalCount }}</span>
                </button>
                <button class="filter-tab" [class.active]="filterStatus === 'active'" (click)="setFilter('active')">
                    <span class="tab-label">Attivi</span>
                    <span class="tab-count">{{ activeCount }}</span>
                </button>
                <button class="filter-tab" [class.active]="filterStatus === 'expired'" (click)="setFilter('expired')">
                    <span class="tab-label">Scaduti</span>
                    <span class="tab-count">{{ expiredCount }}</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Members Grid -->
    <div class="members-content">
        @if (filteredMembers().length > 0) {
        <div class="members-grid">
            @for (member of filteredMembers(); track member.id) {
            <div class="member-card" (click)="goToDetail(member)">
                <div class="member-card-header">
                    <div class="member-avatar">
                        {{ getInitials(member) }}
                    </div>
                    <div class="member-status">
                        @if (member.subscriptionId) {
                        <span class="status-badge active">Attivo</span>
                        } @else {
                        <span class="status-badge expired">Scaduto</span>
                        }
                    </div>
                </div>

                <div class="member-card-body">
                    <h3 class="member-name">{{ member.firstName }} {{ member.lastName }}</h3>
                    <p class="member-email">{{ member.email }}</p>

                    <div class="member-meta">
                        <div class="meta-item">
                            <span class="meta-icon">ðŸ“…</span>
                            <span class="meta-text">Iscritto {{ member.joinedAt | date:'dd/MM/yyyy' }}</span>
                        </div>
                        @if (member.phone) {
                        <div class="meta-item">
                            <span class="meta-icon">ðŸ“ž</span>
                            <span class="meta-text">{{ member.phone }}</span>
                        </div>
                        }
                    </div>
                </div>

                <div class="member-card-footer">
                    <span class="view-details">
                        Vedi dettagli â†’
                    </span>
                </div>
            </div>
            }
        </div>
        } @else {
        <div class="empty-state">
            <div class="empty-icon">ðŸ‘¥</div>
            <h3 class="empty-title">Nessun iscritto trovato</h3>
            <p class="empty-message">
                @if (searchQuery) {
                Nessun risultato per "{{ searchQuery }}"
                } @else {
                Non ci sono ancora iscritti. Inizia aggiungendone uno!
                }
            </p>
            @if (!searchQuery) {
            <app-button (clicked)="openAddModal()">
                Aggiungi primo iscritto
            </app-button>
            }
        </div>
        }
    </div>
</div>